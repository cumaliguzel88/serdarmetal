---
import Container from '../ui/Container.astro';
import SectionTitle from '../ui/SectionTitle.astro';
import type { ServiceKey } from '../../content/services';

interface ServiceEntry {
  id: string;
  key: ServiceKey;
}

interface Props {
  t: <T = string>(key: string) => T;
  services: ServiceEntry[];
}

const { t, services } = Astro.props;
const initialService = services[0];
const initialTitle = t(`services.items.${initialService.key}.title`) as string;
const initialSummary = t(`services.items.${initialService.key}.summary`) as string;
const initialDetail = t(`services.items.${initialService.key}.detail`) as string[];
---

<section id="hizmetler" class="scroll-mt-28 py-16 sm:py-20" data-animate-group>
  <Container>
    <div class="space-y-8">
      <SectionTitle
        eyebrow={t('services.eyebrow')}
        title={t('services.title')}
        description={t('services.description')}
      />

      <div class="grid gap-4 sm:gap-5 md:grid-cols-2 lg:grid-cols-3">
        {services.map((service, index) => {
          const title = t(`services.items.${service.key}.title`) as string;
          const summary = t(`services.items.${service.key}.summary`) as string;
          const detail = t(`services.items.${service.key}.detail`) as string[];

          return (
            <button
              type="button"
              data-animate-item
              data-service-card
              data-service-id={service.id}
              data-service-title={title}
              data-service-summary={summary}
              data-service-detail={JSON.stringify(detail)}
              aria-pressed={index === 0 ? 'true' : 'false'}
              class:list={[
                'service-card group rounded-2xl border border-slate-200 bg-white p-5 text-left shadow-[0_8px_20px_rgba(148,163,184,0.14)] transition duration-200 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--color-accent)]',
                index === 0 && 'is-active'
              ]}
            >
              <p class="font-display text-xl font-semibold tracking-tight text-slate-900">{title}</p>
              <p class="mt-2 text-sm leading-7 text-slate-600">{summary}</p>
            </button>
          );
        })}
      </div>

      <article
        data-service-panel
        data-animate-item
        class="overflow-hidden rounded-3xl border border-slate-200 bg-slate-50 p-6 shadow-[0_14px_28px_rgba(148,163,184,0.16)] sm:p-8"
      >
        <p class="text-xs font-semibold uppercase tracking-[0.22em] text-[var(--color-accent)]">{t('services.detailTitle')}</p>
        <h3 data-service-detail-title class="mt-3 font-display text-2xl font-semibold text-slate-900">{initialTitle}</h3>
        <p data-service-detail-summary class="mt-2 text-base leading-7 text-slate-700">{initialSummary}</p>

        <div data-service-detail-content class="mt-4 space-y-4">
          {initialDetail.map((line) => (
            <p class="text-sm leading-7 text-slate-700 sm:text-base">{line}</p>
          ))}
        </div>

        <p class="mt-5 border-t border-slate-200 pt-4 text-xs font-medium uppercase tracking-[0.18em] text-slate-500">
          {t('services.detailHint')}
        </p>
      </article>
    </div>
  </Container>
</section>
